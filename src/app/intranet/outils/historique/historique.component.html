<section id="mainJournal">
  <!-- Section avec le logo, les médecins et les réalisations -->
  <section id="menuJournalMessage"> <!-- Visible en Desktop -->
    <article>
      <a routerLink="/intranet">
        <span>Tiaki</span>
      </a>
    </article>
    <article>
      <h1>Journaux</h1>
      <h1>de suivi</h1>
    </article>
    <article class="medecin">
      <div>
        <img [src]="[medecinImg]" alt="logo medecin" />
        <h2>Médecins</h2>
      </div>
      <ul>
        @for (medecin of medecins; track medecin) {
          <li>{{ medecin.nom }}</li>
        }
      </ul>
    </article>
    <article class="realisation">
      <div>
        <img [src]="[realisationImg]" alt="logo realisation" />
        <h2>Réalisations</h2>
      </div>
      <ul>
        @for (realisation of realisations; track realisation) {
          <li>
            {{ realisation.nom }}
          </li>
        }
      </ul>
    </article>
  </section>
  <!-- Section comportant l'historique des journaux - Non visible en Mobile-->
  <section>
    <div id="Responsive"> <!-- Div pour le responsive Tablette -->
      <a routerLink="/intranet">
        <span>Tiaki</span>
      </a>
    </div>
    <div>
      <img [src]="[pacman]" alt="" />
      <p>Historiques des journaux sur ces activités</p>
      <!-- Pour utiliser [(ngModel)] je dois importer dans le module FormsModule !!!! -->
      <input name="filtrer" placeholder="Recherche" [(ngModel)]="filtre">
    </div>
    <div>
      <ul>
        @for (historique of historiques | journal:filtre; track historique) {
          <li (click)="changeSelectedJournal(historique.id)">Journal du {{ supa.formatDate(historique.date) }} <br> {{ historique.objet }}</li>
        }
      </ul>
    </div>
  </section>
  <!-- Section Visible seulement en Mobile -->
  <section>
    <div>
      <a routerLink="/intranet">
        <span>Tiaki</span>
      </a>
    </div>
    <div>
      <p>Historiques des journaux sur ces activités</p>
      <mat-form-field>
        <mat-label>Historique</mat-label>
        <mat-select formControlName="historiqueSelect">
          <mat-option>
            <ngx-mat-select-search [formControl]="filtreControl" placeholderLabel="Choisir un journal" noEntriesFoundLabel="Aucun journal correspondant"></ngx-mat-select-search>
          </mat-option>
          @for (historique of historiques | journal:filtreControl.value; track historique) {
            <mat-option (click)="changeSelectedJournal(historique.id)">Journal du {{ supa.formatDate(historique.date) }} <br> {{ historique.objet }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>
  </section>
  <!-- Section Ajouter un journal avec le formulaire -->
  @if (selectedHistorique) {
    <section>
      <article>
        <h3>{{ supa.formatDate(selectedHistorique.date)}}</h3> <!-- J'utilise la méthode formatDate pour formater la date en Fr -->
        <div>
          <button mat-raised-button (click)="deleteJournal(selectedHistorique.id)">Supprimer</button>
          <button mat-raised-button routerLink="/intranet/outils/modifier/{{selectedHistorique.id}}">Modifier</button>
        </div>
      </article>
      <article>
        <h4>Activité concernée</h4>
        <p>Mentionner l'interface concernée, peut-être avec un icone ?</p>
        <h4>Objet</h4>
        <p>{{ selectedHistorique.objet }}</p>
        <h4>Note</h4>
        <p>{{ selectedHistorique.description }}</p>
        <h4>Commentaire</h4>
        <p>{{ selectedHistorique.commentaire }}</p>
        <h4>Journal en rapport</h4>
        @for (linkedJournal of selectedHistorique.linkedJournals; track linkedJournal) {
          <ul>
            <li>
              <span (click)="changeSelectedJournal(linkedJournal.id)">
                {{supa.formatDate(linkedJournal.date) + " - " + linkedJournal.objet}}
              </span>
            </li>
          </ul>
        }
      </article>
    </section>
  }
  @if (!selectedHistorique) {
    <section id="default">
      <p>Veuillez choisir un journal archivé afin de voir ce qu'il contient</p>
    </section>
  }
</section>

<!-- <li>Journal du 16-06-22</li>
<li>Journal du 14-06-22</li>
<li>Journal du 11-09-22</li>
<li>Journal du 09-06-22</li>
<li>Journal du 06-06-22</li>
<li>Journal du 02-06-22</li> -->
